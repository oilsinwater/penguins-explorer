# Story 5.1: Save Visualizations

## Status
Draft

## Story
**As a** user,  
**I want** to save visualizations,  
**so that** I can use them in presentations or share them with colleagues.

## Acceptance Criteria

1. "Download as PNG" button for each chart
2. Filename includes chart type and date
3. Includes title and axis labels
4. Resolution suitable for presentations

## Tasks / Subtasks

- [ ] **Task 1: Download Button Implementation** (AC: 1)
  - [ ] Add "Download as PNG" button to each chart component
  - [ ] Implement chart export functionality using html2canvas
  - [ ] Position button consistently across all charts
  - [ ] Ensure button accessibility (keyboard, screen reader)

- [ ] **Task 2: Filename and Metadata** (AC: 2, 3)
  - [ ] Generate descriptive filenames (e.g., scatter-2024-01-15.png)
  - [ ] Include chart title and axis labels in export
  - [ ] Add metadata for accessibility compliance
  - [ ] Test filename uniqueness and correctness

- [ ] **Task 3: Quality and Resolution** (AC: 4)
  - [ ] Export at high resolution (2x DPI for Retina displays)
  - [ ] Ensure text clarity and readability
  - [ ] Test export quality with various chart sizes
  - [ ] Optimize file size without losing quality

- [ ] **Task 4: Testing Implementation**
  - [ ] Write Cypress tests for download functionality
  - [ ] Test filename generation accuracy
  - [ ] Verify chart quality and resolution
  - [ ] Validate accessibility compliance

## Dev Notes

### Export Requirements
**Source: [architecture/tech-stack.md#ui-framework]**
- Use html2canvas for client-side chart rendering
- Support for Retina/high-DPI displays
- Accessible button styling and positioning
- Keyboard navigation support for download buttons

### File Naming Standards
**Source: [architecture/tech-stack.md#state-management]**
- Format: {chartType}-{YYYY-MM-DD}.png
- Include timestamp for versioning
- Sanitize filenames for cross-platform compatibility
- Store export metadata for future enhancements

### Component Integration
**Source: [architecture/source-tree.md]**
- Chart components: `src/components/charts/`
- Export utilities: `src/utils/export.ts`
- Button components: `src/components/ChartExportButton.tsx`
- Test files: `src/export/-tests/`

### Testing Requirements
**Source: [architecture/testing-strategy.md]**
- Test file: `src/export/-tests/Export.cy.ts`
- Key scenarios:
  - Download button functionality
  - Filename generation accuracy
  - Chart quality and resolution
  - Accessibility compliance
  - Cross-browser compatibility
- Dependency: Requires completed chart components (Stories 3.1-3.3)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-09-04 | 1.0 | Created from PRD US5.1 | BMad SM |