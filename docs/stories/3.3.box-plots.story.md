# Story 3.3: Compare Distributions with Box Plots

## Status
Ready

## Story
**As a** user,  
**I want** to compare distributions with box plots,  
**so that** I can analyze statistical summaries and identify outliers in penguin measurements.

## Acceptance Criteria

1. Shows quartiles, median, outliers
2. Grouped by species
3. Variable selection dropdown
4. Hover shows exact statistics
5. Handles missing values gracefully

## Tasks / Subtasks

- [ ] **Task 1: Box Plot Component** (AC: 1, 2, 3)
  - [ ] Create `src/components/charts/BoxPlot.tsx`
  - [ ] Implement variable selection dropdown (bill_length, bill_depth, flipper_length, body_mass)
  - [ ] Group data by species for comparison
  - [ ] Calculate and display quartiles, median, outliers

- [ ] **Task 2: Statistical Calculations** (AC: 1, 4, 5)
  - [ ] Implement box plot statistics calculation logic
  - [ ] Handle missing values in selected variable
  - [ ] Add hover tooltips with exact statistics
  - [ ] Optimize calculations for performance

- [ ] **Task 3: Data Integration** (AC: 2, 4)
  - [ ] Connect to filtered penguin data from Zustand store
  - [ ] Update calculations when filters change
  - [ ] Display species groupings clearly
  - [ ] Ensure outlier detection accuracy

- [ ] **Task 4: Testing Implementation**
  - [ ] Write Cypress tests for variable selection
  - [ ] Test statistical calculation accuracy
  - [ ] Verify hover tooltip information
  - [ ] Validate missing value handling

## Dev Notes

### Component Specifications
**Source: [architecture/tech-stack.md#ui-framework]**
- Use Strudel Chart components (box plot variant)
- Follow statistical visualization best practices
- Implement clear outlier markers
- Support keyboard navigation for species groups

### Data Processing
**Source: [architecture/tech-stack.md#state-management]**
- Calculate quartiles, median, IQR per species
- Identify outliers using 1.5 * IQR rule
- Debounce visualization updates (250ms)
- Handle edge cases (small sample sizes)

### File Structure
**Source: [architecture/source-tree.md]**
```
src/
└── components/
    └── charts/
        ├── BoxPlot.tsx         # Main box plot component
        └── ChartControls.css   # Shared chart styles
```

### Testing Requirements
**Source: [architecture/testing-strategy.md]**
- Test file: `src/components/charts/-tests/BoxPlot.cy.ts`
- Key scenarios:
  - Variable selection accuracy
  - Statistical calculation verification
  - Species grouping clarity
  - Outlier detection correctness
  - Tooltip statistic accuracy
- Dependency: Requires completed histogram story (3.2) for chart infrastructure

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-09-04 | 1.0 | Created from PRD US3.3 | BMad SM |