# Story 3.2: See Distributions with Histograms

## Status
Draft

## Story
**As a** user,  
**I want** to see distributions with histograms,  
**so that** I can understand the spread and frequency of different penguin measurements.

## Acceptance Criteria

1. Dropdown to select variable
2. Species shown as overlapping distributions
3. Adjustable bin size (5, 10, 20 bins)
4. Y-axis shows count
5. Clear color/pattern distinction for species

## Tasks / Subtasks

- [ ] **Task 1: Histogram Component** (AC: 1, 2, 5)
  - [ ] Create `src/components/charts/Histogram.tsx`
  - [ ] Implement variable selection dropdown (bill_length, bill_depth, flipper_length, body_mass)
  - [ ] Display overlapping distributions for each species
  - [ ] Use distinct colors/patterns per species (Strudel palette)

- [ ] **Task 2: Bin Size Controls** (AC: 3, 4)
  - [ ] Add bin size selector (5, 10, 20 options)
  - [ ] Update Y-axis to show count values
  - [ ] Implement bin calculation logic
  - [ ] Ensure performance with large datasets

- [ ] **Task 3: Data Integration** (AC: 1, 2)
  - [ ] Connect to filtered penguin data from Zustand store
  - [ ] Handle missing values in selected variable
  - [ ] Calculate distribution data per species
  - [ ] Optimize rendering for overlapping distributions

- [ ] **Task 4: Testing Implementation**
  - [ ] Write Cypress tests for variable selection
  - [ ] Test bin size adjustments
  - [ ] Verify species distribution visualization
  - [ ] Validate Y-axis count accuracy

## Dev Notes

### Component Specifications
**Source: [architecture/tech-stack.md#ui-framework]**
- Use Strudel Chart components (histogram variant)
- Implement transparent overlap for species comparison
- Follow WCAG 2.1 contrast ratios for accessibility
- Support touch interactions for bin controls

### Data Processing
**Source: [architecture/tech-stack.md#state-management]**
- Calculate histogram bins from filtered data
- Debounce visualization updates (200ms)
- Handle edge cases (single value, all nulls)
- Optimize distribution calculations per species

### File Structure
**Source: [architecture/source-tree.md]**
```
src/
└── components/
    └── charts/
        ├── Histogram.tsx       # Main histogram component
        └── ChartControls.css   # Shared chart styles
```

### Testing Requirements
**Source: [architecture/testing-strategy.md]**
- Test file: `src/components/charts/-tests/Histogram.cy.ts`
- Key scenarios:
  - Variable selection functionality
  - Bin size adjustment impact
  - Species distribution overlap clarity
  - Y-axis count accuracy
  - Performance with 344 records
- Dependency: Requires completed filtering system (Stories 2.1-2.4)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-09-04 | 1.0 | Created from PRD US3.2 | BMad SM |