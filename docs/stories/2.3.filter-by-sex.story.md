# Story 2.3: Filter Penguins by Sex

## Status
Ready

## Story
**As a** user,  
**I want** to filter penguins by sex,  
**so that** I can analyze biological differences between male and female penguins.

## Acceptance Criteria

1. Radio buttons: All, Male, Female
2. Handles missing sex values appropriately
3. Mutually exclusive selection
4. Default "All" state functional

## Tasks / Subtasks

- [ ] **Task 1: Implement Sex Filter Component** (AC: 1, 3, 4)
  - [ ] Create `src/components/filters/SexFilter.tsx`
  - [ ] Use Strudel RadioGroup component
  - [ ] Ensure mutual exclusion of selections
  - [ ] Validate keyboard navigation (arrow keys)

- [ ] **Task 2: Handle Missing Values** (AC: 2) 
  - [ ] Implement defensive handling for null/undefined sex values (future-proofing)
  - [ ] Document behavior: Missing values excluded from Male/Female filters  
  - [ ] Note: Current dataset (3,430 penguins) has no missing sex values

- [ ] **Task 3: State Integration** (AC: 1, 3)
  - [ ] Update `src/stores/filterStore.ts` with sex state
  - [ ] Implement default 'All' selection
  - [ ] Synchronize with URL parameters

- [ ] **Task 4: Testing Implementation**
  - [ ] Write Cypress tests for radio button interactions
  - [ ] Verify defensive missing value handling (even though dataset has none)
  - [ ] Test URL sync for all filter states  
  - [ ] Validate accessibility tree for screen readers
  - [ ] Test with expected counts: 1,704 Male, 1,726 Female

## Dev Notes

### UI Component Requirements
**Source: [architecture/tech-stack.md#ui-framework]**
- Strudel RadioGroup with accessible labels
- Required `aria-describedby` for missing value explanation
- Keyboard focus management

### Data Handling
**Source: [architecture/tech-stack.md#state-management]**
- Zustand store integration
- URL sync via `useSearchParams`
- Filter logic: `null` values excluded from Male/Female (defensive coding)
- Dataset: 3,430 total penguins (1,704 Male, 1,726 Female, 0 missing)

### File Structure
**Source: [architecture/source-tree.md]**
```
src/
└── components/
    └── filters/
        ├── SexFilter.tsx     # Sex-specific component
        └── FilterGroup.css   # Shared filter styles
```

### Testing Notes
**Source: [architecture/testing-strategy.md]**
- Test file: `src/components/filters/-tests/SexFilter.cy.ts`
- Critical test scenarios:
  - Default 'All' state
  - Filtering with null sex values
  - Keyboard navigation between options
  - URL parameter changes reflecting selections
- Dependency: Requires completed Species/Island filters (Stories 2.1-2.2)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-09-04 | 1.0 | Created from PRD US2.3 | BMad SM |